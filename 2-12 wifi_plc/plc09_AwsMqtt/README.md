## 와이파이를 이용한 PLC 제어 (7) 
인터넷 아마존크라우드에 node-RED와 mongoDB를 설치하고, mqtt 통신을 이용하여 PLC가 동작하면 DB에 자동 등록되어 UI에 나타난 PLC를 모니터링과 제어를 할수있다.

여기서 다음 기법을 소개한다.

설명1. 연결된 기기의 자동 등록과 업데이트
PLC가 연결되면 monogoDB에서 plc의 chipid로 검색하여 존재하지 않으면 DB에 추가한다.

설명2. DB 데이터를 ui led로 표시
해당 plc의 데이터를 led로 표시한다. 배열의 형태로 바꾸며 전달되는 인수는 msg.payload 형식이어야 한다. 여기서 이를 push로 처리한다.

설명3. PLC 데이터 배열을 Dropdown노드로 표시
DB에 존재하는 plc 데이터를 배열로 만들어 Dropdown node에 표시하고 프로그램이 시작되면 자동 실행되게 한다.

설명4. 스의치 노드의 데이터를 json 으로 처리
보통의 스위치는 ture 또는 false 한가지를 전달하지만 여기서 json 형식으로 하여 2가지 이상의 변수를 전달하여 프로그램을 단순화 하였다. 

설명5. 원격으로 모니터링 모드 설정
monit 변수를 전달하여 이를 on 함으로 현장 plc 임력값을 주기적으로 서버에 전달 하게 하였다. 출력은 항상 실행 한다.